高鐵票 QR-Code 格式說明
====


目前高鐵閘門可以讀取 QR-Code 、磁條、感應卡這三大類，而在超商訂/取票或是透過 T-express 手機訂票的都是拿到 QR-Code ，所以過閘門時就是透過光學掃描機來感應 QR-Code 內容來辨識乘車資料。

強者我朋友 Chris Lai 跟我都是常搭高鐵的人，因此就很無聊的一起來研究高鐵票的規則，因此以下的研究就是 Chris Lai 與我一起找到的，這些高鐵票的規則是用數十張各種票種推算出來的結果，有些部分還是不確定，歡迎也有研究的人一起來交流。

### QR-Code 格式

* 高鐵票的 QR-Code 為標準 ISO 18004 且沒有任何加密
* 字串長度為 124 碼


### QR-Code 內容

總長為 124 碼，前 118 碼純數字（研判單純是 DEC ），最後 6 碼英數混合（英文字只有出現到 A 到 F ，所以研判對系統來說應該是 HEX ）。然後資料是分為 15 個區塊，如下：

* 車票號碼（13碼）
* 訂位代碼（8碼）
* 車次（7碼，長度不滿的前面補0）
* 出發站（3碼，001代表南港站，以此類推，因此高雄站就是012）
* 出發時間（14碼，格式為 yyyymmddhhmmss）
* 抵達站（3碼，001代表南港站，以此類推，因此高雄站就是012）
* 抵達時間（14碼，格式為 yyyymmddhhmmss）
* 票種與折扣（13碼，目前還不確定詳細規則，僅發現當票價有優惠時會有變動）
* 車廂（3碼，長度不滿的前面補0）
* 座位排（3碼，長度不滿的前面補0）
* 座位編號（3碼，長度不滿的前面補0，001代表A，以此類推）
* 票價（10碼，長度不滿的前面補0）
* 付款方式（16碼，目前還不確定詳細規則）
* 搭車日期（8碼，格式為 yyyymmdd）
* 隨機碼（6碼，為 HEX 且不知道運算方式）


備註1：票種與折扣這欄位，在交叉比對後發現，如果票種是一般票且為原價票，就一定是 0100000010000 ，然後如果有任何折扣（例如學生優惠、離峰或早鳥）那就會是 0110000010000 ，目前因為手邊沒有愛心、敬老、兒童的票種，所以無法完全找出這欄位的規則，歡迎有上述票種的朋友把過期的 QR-Code 拍給我看 <(_ _)>


備註2：付款方式這欄位，目前已經發現信用卡付款都是 0060010000000000 ，而不論訂票平台為何只要是在超商付款都是 0060000000000000 ，但目前還不確定的有銀連卡因為是另外的付款介面、高鐵人工窗口、高鐵自動售票機所買出的票會不會有其他的代碼，所以想問問大家有沒有磁條機可以借我嘗試讀取看看磁條票的規則是否一樣。


### 總結

你一定會問，讀出這東西來有什麼意義，我只能說看下去你就會懂了 :)

如果，今天有一個服務可以幫你把你從超商買好的高鐵票，變成你 iPhone 中的一張卡片，然後在你靠近高鐵站或是時間快到的時候就自動在鎖定畫面跳出來，這樣就可以跟各大航空的電子登機證一樣方便了！

註：如果高鐵願意自己做就更好了...


